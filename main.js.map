{"version":3,"file":"main.js","mappings":"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","sources":["webpack:///./src/js/stream/yt.js","webpack:///./src/js/player.js","webpack:///./src/js/background.js","webpack:///./src/js/shortcuts.js","webpack:///./src/js/index.js","webpack:///./src/js/static.js"],"sourcesContent":["class State {\n  STOPPED = 0\n  PLAYING = 1\n}\n\nexport default class YouTube {\n  constructor(player_el, stream_url) {\n    this.player_el = player_el;\n  }\n\n  setup(){\n    var yt_iframe = document.createElement(\"iframe\");\n    yt_iframe.setAttribute(\"allow\", \"autoplay; encrypted-media;\");\n    yt_iframe.setAttribute(\"src\", stream.url + \"?enablejsapi=1\");\n    this.player_el.appendChild(yt_iframe);\n    this.state = State.STOPPED;\n  }\n\n  post_message(message) {\n    this.player_el.childNodes[0].contentWindow.postMessage('{\"event\":\"command\",\"func\":\"' + message + '\",\"args\":\"\"}', '*')\n  }\n\n  play() {\n    if (this.state == State.STOPPED) {\n      this.post_message('playVideo')\n      this.state = State.PLAYING;\n    }\n  }\n\n  stop() {\n    if (this.state == State.PLAYING) {\n      this.post_message('stopVideo')\n      this.state = State.STOPPED;\n    }\n  }\n\n  toggle() {\n    if (this.state == State.PLAYING) {\n      this.stop();\n      return;\n    }\n    else if (this.state == State.STOPPED) {\n      this.play();\n      return;\n    }\n  }\n\n  destroy() {\n    this.stop()\n    while (this.player_el.lastChild) {\n      this.player_el.removeChild(this.player_el.lastChild);\n    }\n    this.state == undefined;\n  }\n}\n","import YouTube from \"./stream/yt.js\"\n\nexport default class Player {\n  STREAMS_URL = \"streams.json\"\n\n  STREAMERS = {\n    \"www.youtube.com\": YouTube\n  }\n\n  constructor (player_el) {\n    this.player_el = player_el;\n  }\n\n  get_json(url, callback) {\n    fetch(backgrounds_url)\n      .then(function(response) {\n        if (!response.ok) {\n          throw new Error(\"HTTP error, status = \" + response.status);\n        }\n        return response.json();\n      })\n      .then(callback)\n      .then(() => {this.play()})\n      .catch(function(error) {\n        console.log(error.message);\n      });\n  }\n\n  handle_streams(streams) {\n    this.update_stream(this.random_choice(streams));\n  }\n\n  random_choice(arr){\n    return arr[Math.floor(Math.random() * arr.length)];\n  }\n\n  update_stream (stream) {\n    if (this.streamer) {this.streamer.destroy()}\n\n    const stream_url = new URL(stream.url);\n    this.streamer = this.STREAMERS[stream_url.hostname](this.player_el, stream.url)\n    this.streamer.setup()\n  }\n\n  pause() {\n    this.streamer.stop();\n  }\n\n  play() {\n    this.streamer.play();\n  }\n\n  toggle() {\n    this.streamer.toggle();\n  }\n\n  clear(){\n    if (this.streamer) {this.streamer.destroy()};\n  }\n\n  start() {\n    this.get_json(this.STREAMS_URL, this.handle_streams)\n  }\n}\n","export default class BackgroundVideo {\n  BACKGROUND_VIDEO_URL = \"backgrounds.json\"\n  constructor (background_video_el) {\n    this.background_video_el = background_video_el;\n    this.background_video_el.defaultPlaybackRate = 0.5;\n  }\n\n  get_json(url, callback) {\n    fetch(backgrounds_url)\n      .then(function(response) {\n        if (!response.ok) {\n          throw new Error(\"HTTP error, status = \" + response.status);\n        }\n        return response.json();\n      })\n      .then(callback)\n      .catch(function(error) {\n        console.log(error.message);\n      });\n  }\n\n  handle_backgrounds(backgrounds) {\n    this.update_video(this.random_choice(backgrounds));\n  }\n\n  random_choice(arr){\n    return arr[Math.floor(Math.random() * arr.length)];\n  }\n\n  update_video (background) {\n    this.background_video_el.setAttribute(\"src\", background.url);\n  }\n\n  start() {\n    this.get_json(this.BACKGROUND_VIDEO_URL, this.handle_backgrounds)\n  }\n}\n","export default class Shortcuts {\n  KEY_MAP = {\n    \"Space\": this.space\n  }\n\n  constructor(background, player) {\n    this.background = background;\n    this.player = player;\n  }\n\n  setup() {\n    document.addEventLisenter(\"keypress\", (e) => {\n      e = e || window.event;\n\n      this.KEY_MAP[e.code](e)\n    })\n  }\n\n  space (e) {\n    this.player.toggle();\n  }\n}\n","import StaticPlayer from \"./static.js\";\n\n(function () {\n  const static_player = new StaticPlayer();\n  static_player.run();\n})();\n","import Player from \"./player.js\";\nimport Background from \"./background.js\";\nimport Shortcuts from \"./shortcuts.js\";\n\nexport default class StaticPlayer {\n  PLAYER_EL_ID = \"player\"\n  BACKGROUND_VIDEO_EL_ID = \"background-video\"\n\n  #background_video;\n  #background;\n  #player_el;\n  #player;\n  #shortcuts;\n\n\n  get background_video_el (){\n    if (!this.#background_video){\n      this.#background_video = document.getElementById(this.BACKGROUND_VIDEO_EL_ID);\n    }\n    return this.#background_video;\n  }\n\n  get background() {\n    if (!this.#background) {\n      this.#background = new Background(this.background_video_el);\n    }\n    return this.#background;\n  }\n\n  get player_el (){\n    if (!this.#player_el) {\n      this.#player_el = document.getElementById(this.PLAYER_EL_ID);\n    }\n    return this.#player_el;\n  }\n\n  get player(){\n    if(!this.#player) {\n      this.#player = new Player(this.player_el);\n    }\n    return this.#player;\n  }\n\n  get shortcuts() {\n    if (!this.#shortcuts) {\n      this.#shortcuts = new Shortcuts(this.background, this.player);\n    }\n    return this.#shortcuts;\n  }\n\n  run() {\n    this.shortcuts.setup();\n    this.player.start();\n    this.background.start();\n  }\n}\n"],"names":["State","STOPPED","PLAYING","YouTube","constructor","player_el","stream_url","this","setup","yt_iframe","document","createElement","setAttribute","stream","url","appendChild","state","post_message","message","childNodes","contentWindow","postMessage","play","stop","toggle","destroy","lastChild","removeChild","Player","STREAMS_URL","STREAMERS","get_json","callback","fetch","backgrounds_url","then","response","ok","Error","status","json","catch","error","console","log","handle_streams","streams","update_stream","random_choice","arr","Math","floor","random","length","streamer","URL","hostname","pause","clear","start","BackgroundVideo","BACKGROUND_VIDEO_URL","background_video_el","defaultPlaybackRate","handle_backgrounds","backgrounds","update_video","background","Shortcuts","KEY_MAP","space","player","addEventLisenter","e","window","event","code","PLAYER_EL_ID","BACKGROUND_VIDEO_EL_ID","getElementById","run","shortcuts"],"sourceRoot":""}